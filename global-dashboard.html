<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Global Stats â€“ ImpactTrack</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>

  <script type="module">
    import { requireAuth, setupNav } from './auth-common.js';
    import { db } from './firebase-init.js';
    import { doc, onSnapshot } from 'https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore.js';

    requireAuth();
    setupNav();

    // Listen to your global stats docs
    const compostRef = doc(db, 'stats', 'compost');
    const cleanupRef = doc(db, 'stats', 'cleanup');
    const usersRef   = doc(db, 'stats', 'users');

    onSnapshot(compostRef, snap =>
      document.getElementById('total-compost').textContent = snap.data().total
    );
    onSnapshot(cleanupRef, snap =>
      document.getElementById('total-cleanup').textContent = snap.data().total
    );
    onSnapshot(usersRef, snap =>
      document.getElementById('user-count').textContent = snap.data().count
    );
  </script>

  <h1>Global Stats</h1>
  <div id="global-stats">
    <p>Total composted: <span id="total-compost">0</span> kg</p>
    <p>Total cleanup: <span id="total-cleanup">0</span> mins</p>
    <p>Total users: <span id="user-count">0</span></p>
  </div>

</body>
</html>
